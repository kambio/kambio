
ISSUER=passet_issuer 
SELECTOR=passet_choose 
TRANSFER=passet_transfer 
PROTO=-mudp
# PROTO=-tcp

cd /home/jose/tmp/passet_test

PORT_1=9201
PORT_2=9202
PORT_3=9203
PORT_4=9204

GLI_1=`$ISSUER -k "usu1" $PROTO -prt_glid`
GLI_2=`$ISSUER -k "usu2" $PROTO -prt_glid`
GLI_3=`$ISSUER -k "usu3" $PROTO -prt_glid`
GLI_4=`$ISSUER -k "usu4" $PROTO -prt_glid`

START_TM=`get_time_sh`

$ISSUER -k usu1 $PROTO -dbg_no_end_cho
$ISSUER -k usu2 $PROTO -dbg_no_end_cho
$ISSUER -k usu3 $PROTO -dbg_no_end_cho
$ISSUER -k usu4 $PROTO -dbg_no_end_cho

CHO1=./cho1.nm
CHO2=./cho2.nm
CHO3=./cho3.nm
CHO4=./cho4.nm
CHO5=./cho5.nm
CHO6=./cho6.nm

$TRANSFER -k usu1 $PROTO -chann -port "$PORT_1" -r "$GLI_2"
$SELECTOR -k usu1 $PROTO -cd $GLI_2 +1 5z3
$TRANSFER -k usu1 $PROTO -send -port "$PORT_1" -r "$GLI_2" -f_for_cho $CHO1
echo ""
echo ""
echo ""
echo "ONE FINISHED ONE FINISHED ONE FINISHED"


$TRANSFER -k usu2 $PROTO -chann -port "$PORT_2" -r "$GLI_3"
$SELECTOR -k usu2 $PROTO -cd $GLI_3 +1 5z3
$TRANSFER -k usu2 $PROTO -send -port "$PORT_2" -r "$GLI_3" -f_for_cho $CHO2
echo ""
echo ""
echo ""
echo "TWO FINISHED TWO FINISHED TWO FINISHED"


$TRANSFER -k usu3 $PROTO -chann -port "$PORT_3" -r "$GLI_4"
$SELECTOR -k usu3 $PROTO -cd $GLI_4 +1 5z3
$TRANSFER -k usu3 $PROTO -send -port "$PORT_3" -r "$GLI_4" -f_for_cho $CHO3
echo ""
echo ""
echo ""
echo "THREE FINISHED THREE FINISHED THREE FINISHED"

$TRANSFER -k usu4 $PROTO -chann -port "$PORT_4" -r "$GLI_1"
$SELECTOR -k usu4 $PROTO -cd $GLI_1 -dn "$GLI_1" +1 5z3
$TRANSFER -k usu4 $PROTO -split -port "$PORT_4" -r "$GLI_1" -f_for_cho $CHO4
echo ""
echo ""
echo ""
echo "FOUR FINISHED FOUR FINISHED FOUR FINISHED"


$TRANSFER -k usu4 $PROTO -chann -port "$PORT_4" -r "$GLI_3"
$SELECTOR -k usu4 $PROTO -cd $GLI_3 +2 2z3 +1 1z3
$TRANSFER -k usu4 $PROTO -send -port "$PORT_4" -r "$GLI_3" -f_for_cho $CHO5
echo ""
echo ""
echo ""
echo "FIVE FINISHED FIVE FINISHED FIVE FINISHED"


$TRANSFER -k usu3 $PROTO -chann -port "$PORT_3" -r "$GLI_1"
$SELECTOR -k usu3 $PROTO -cd $GLI_1 -dn "$GLI_1" +2 2z3 +1 1z3
$TRANSFER -k usu3 $PROTO -join -port "$PORT_3" -r "$GLI_1" -f_for_cho $CHO6
echo ""
echo ""
echo ""
echo "SIX FINISHED SIX FINISHED SIX FINISHED"


CHO1_NM=`cat $CHO1`
CHO2_NM=`cat $CHO2`
CHO3_NM=`cat $CHO3`
CHO4_NM=`cat $CHO4`
CHO5_NM=`cat $CHO5`
CHO6_NM=`cat $CHO6`

$ISSUER -k usu1 $PROTO -r $GLI_2 -ck_choice_name $CHO1_NM
$ISSUER -k usu2 $PROTO -r $GLI_3 -ck_choice_name $CHO2_NM
$ISSUER -k usu3 $PROTO -r $GLI_4 -ck_choice_name $CHO3_NM
$ISSUER -k usu4 $PROTO -r $GLI_1 -ck_choice_name $CHO4_NM
$ISSUER -k usu4 $PROTO -r $GLI_3 -ck_choice_name $CHO5_NM
$ISSUER -k usu3 $PROTO -r $GLI_1 -ck_choice_name $CHO6_NM

$SELECTOR -k usu3 $PROTO 

echo "TOTAL TIME="
get_time_sh $START_TM

